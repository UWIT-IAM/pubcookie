Changes with 3.1.0:

*) Added code to detect AIX and module upgrades and set a conditional 
   for make to exclude portions of the Makefile. 
   [miner]

*) Added a warning about running slibclean to the Makefile to display a 
   warning if we're upgrading on an AIX machine.
   [miner]

*) Added krb5_service_name variable to verify_kerberos5.c, so the 
   login cgi can use its own service key and not the host principal
   that other services use.
   [willey]

*) Added more debugging for Kerberos authentication.
   [willey]
  
*) Created "apache2" branch and applied Lars Uffmann's patch to 
   post 3.0.0 code. Applied second patch from Lars.
   [willey]

*) Applied Leif Johansson's no addrs patch for setting up my initial
   (heimdal) Kerberos TGT options: sets a null list of addresses.
   Forwarded credentials typically need to have the address of the app
   server in them as oposed to the addresses of the login server. 
   [willey]

*) Added autoconf test to detect and support Heimdal Kerberos
   [willey]

*) Create a session key pair on the fly if the files don't exist.  
   #ifdefed for WIN32. This change allows a filter installation to
   contain no private keys on disk.
   [ryanc]

*) Added pbc_messages.dll to get rid of the "description for Event ID
   ( foo ) in Source ( foo ) cannot be found" error in the event 
   [ryanc]

*) ISAPI filter now threadsafe. Only one filter loaded for all web
   instances and IP addresses. No global variables.  Context pointer
   is passed between all functions in filter that are in ISAPI control
   flow.  Startup functions have no context and are only called once. 
   Filter no longer keeps global statistics or any other global state. 
   [ryanc]

*) All filter logging now done to event log. Filter will create logging
   sources for PubCookie and PubCookie-<x> where <x> is the current
   web instance. 
   [ryanc]
 
*) Removed PubcookieFilter_Reset feature since there is no longer any
   global state to reset.
   [ryanc]

*) Fixed user field static on expired login cookie
   [steve]

*) Added keyserver "permit" option for authorizing new servers.
   [fox]

*) When changing between flavors username is static.
   [steve]

*) Changed login cgi logging format and content, and added IP, to auth 
   success log message.
   [steve]

*) Added verify_fork.c from Tim Funk <funkman@joedog.org> 
   [steve]

*) Better out-of-the-box autoconf action on RedHat.
   [steve]

*) Updated flavor_basic to allows multiple token substitution in
   sub-templates for login page; to put cursor in correct field on
   login page; to make username from expired login cookie or on reauth
   unchangable (should probably be an option); to accept valid login 
   cookies from other flavors.
   [steve]

*) Added login_unauth_grant template and log entry from login cgi for
   unauthorized hosts that make an authn request.
   [fox]

*) Updated Win32 keyclient to use new threadsafe code. keyclient 
   itself is still single threaded.
   [ryanc]

*) Updated login cgi to delete login cookie on 'really logout'
   [fox]

*) Added ability to write to mirrorfile from ntmpl templates and 
   better (templatable) message for authn server problems.
   [willey]

*) Added static_user_field variable to decide when the user field is
   static or edittable by the user.
   [willey]

*) Updated OpenSSL build to 0.9.7c for Win32.
   [ryanc]

*) Updated PubCookieFilter project to Visual Studio .NET format.
   [ryanc]

*) Added support for virtual hostnames.
   [ryanc]

*) Make config file key lookups case insensitive 
   [willey]

*) Removed some memory leaks 
   [willey]

*) Added use_granting flag to all encrypt/sign calls.  This lets a call
   use a named peer for the DES key and the local session keypair for 
   signing at the same time.  Required for virtual host support.
   [ryanc]

*) Added trim_username_to_atsign variable as a site policy on trimming
   usernames at the first at sign.
   [willey]

*) Added retain_username_on_failed_authn variable to retain the
   username on failed auths. 
   [willey]

*) Removed hardcoded copyright text from click-to-continue POST page
   generated by the Apache module.
   [willey]

*) Fixed virtual server in mod_pubcookie.
   [jeaton]

*) Retired debug variable, use logging_level. Also fixed some logging 
   levels.
   [willey]

*) Added new kiosk mode configuration. 
   [fox]

*) In preparation for multiple server configs, functions now pass the 
   Apache memory pool parameter p, which has been defined for Windows
   as type pubcookie_dir_rec. This allows removal of some Windows 
   specific code, but adds some header complexity. May provide a
   small performance boost as some stack-allocated buffers were
   eliminated in favor of one new buffer in pubcookie_dir_rec. 
   [ryanc]

*) Windows pbc_myconfig functions now work for Unicode or ANSI
   strings. 
   [ryanc]

*) ISAPI filter now supports configuration for each web instance;
   default is still in main pubcookie filter service key.  Arbitrary
   config is possible by inventing a fictitious web instance, this is
   done for the relay cgi for example. 
   [ryanc]

*) Added relay capability for cross-domain authentication
   [fox]

*) Added login form timeout and corresponding form_expired template
   [fox]


*) Merged security-context branch for better virtual host support in 
   Apache module. 
   [jeaton]

*) Enhanced PubcookieSessionCauseReAuth to accept a number-of-seconds
   parameter. If the user has entered a password in less time than
   this parameter they don't have to reenter a password. Added 
   necessary changes login cgi too.

*) Apache 2.0 now supported
   [fox]

*) Changed the behavior of the module install to prepend a '#' to the
   LoadModule line for pubcookie.  This can be removed when the admin
   adds the other pubcookie config lines.
   [fox]
 
*) Build improvements. APACHE1_3 is defined for a version 1.3 build of
   apache.  APACHE2 is defined for an apache 2.0 build.  APACHE is now
   defined in the Makefile for any module build. 
   [fox]

*) Restored read timeouts to version 1.3 modules.  Not needed in 2.0.
   Restored check for SSL. Requires 1.3 or at least 2.0.49.
   [fox]

*) Modified keyclient and keyserver to distribute granting cert. Usage:
   ./keyclient -G <output_filename>
   [fox]

*) Send keyclient errors to stderr instead of syslog so they're seen.
   [jeaton]

*) Added granting cert download option to Win32 keyclient.
   [ryanc]

*) Added new PubCookieOnDemand and PubCookieNoPrompt directives.
   [fox]
 
*) Installed a common command_rec for both apache 1.3 and 2.0 to make
   maintenance easier.
   [fox]

*) Modified keyserver: no keyserver_client_list now means no 
   restriction on access. This was the original setting and seems to
   be the most flexible. 
   [fox]

*) Modified ISAPI filter to prevent looping when granting cookie has 
   expired. Now causes an error message.
   [ryanc]

*) Added FastCGI support to login cgi. This allows one or more
   index.cgi programs to persist as a FastCGI process and handle many
   requests. Configure with: --with-fcgi=<path to fcgi install>.  For
   reference see: http://www.fastcgi.com/
   [fox]
 
*) Remove the global server variable (globalsr) from the Apache2
   module. 
   [fox]
 
*) Fixed pubcookie library logging to work correctly in the module.
   Follows Apache's LogLevel.
   [fox]
 
*) Configure now looks for kerberos dependency in OpenSSL.
   [fox]
 
*) Fixed occasional core dump during some subrequests, e.g., on
   directory indexes.
   [fox]

*) Added PubCookieNoPrompt capability to the getcred flavor.
   [fox]

*) Fixed redirect to the login server so that Safari won't cache it.
   [jeaton]

*) Fixed missing cgi counters to non-fcgi version.
   [fox]

*) Cleaned up code to prevent compiler warnings.
   [jeaton]

*) Added credential cache cleanup patch from Christopher Maxwell.
   Also (thanks to Leif Johansson) uniqified credential cache
   everywhere.
   [jeaton]

*) Fixed keyclient to run without an existing granting cert and made 
   help text easier to read.
   [fox]
 
*) Apache module needed a local "ap_get_local_host" to work on AIX and
   Apache 2.x. Problem with apache's exported symbols. 
   [fox]
    
*) Moved module build to separate directory, generated by configure,
   to avoid compilation conflicts between shared files.
   [fox]
 
*) Fixed module DSO build to work for Apache 1.3 and 2.x on linux and 
   AIX. Don't have any other systems to try.
   [fox]
 
*) Added static module build for apache 1.3. Static modules not
   supported in apache 2.x. Configure options for module:
   --enable-apache        enables building of module (default on)
   --with-apxs=PATH       builds DSO module (path is to apxs)
   --with-apache-src=DIR  configures static build (DIR/src/modules/pubcookie) 
   [fox]

*) Configure now requires either --with-apxs or --with-apache-src to
   build the module. 
   [fox]
 
*) Provide default DSO module build if apxs is found in the users path.
   [fox]

*) Modified keyserver to lowercase hostnames when creating file names 
   for keys.
   [willey]

*) Add config.h and pbc_path.h to list of files linked to module dir.
   [fox]

*) Fixed keyclient to exit with status 0 on success, status 1 on error.
   [fox]

*) Updated CMU templates in pubcookie/src/login_templates.cmu.
   [jeaton]

*) In IIS MMC, an AuthType defined as a null string will now not 
   show up as a choice in the drop-down for AuthType in the directives
   view.  Any AuthType can thus be removed from the AuthType directive
   list by setting it to a null string in the Server Variables view. 
   [ryanc]

*) Added in missing LIBS so that it links mod_pubcookie to libssl and
   libcrypto, like it should (and used to do); also need the LDFLAGS 
   so we can find the libraries.
   [jeaton]

*) Fixed problem on systems with both Apache 1.3 and 2.0: configure 
   sometimes used the wrong apxs. 
   [fox]

*) Added new Makefiles and relay cgi to distribution. 
   [fox]

*) Added No_Prompt support to ISAPI filter and config.
   [ryanc]

*) Modified Apache build: Don't try to make module if static module 
   build; don't try to install module on static build; lLook for apxs
   in the usual places for default build; don't look for apxs on
   static module build.
   [fox]

*) Updated documentation mainly for P3.1
   [dors]

*) Prevent looping between login server and Apache module when
   granting cookie has expired. 
   [steve]

*) Modified keyserver to break hung connections. The config variable
   keyserver_max_wait_time variable sets the maximum time it will wait
   for data after a connection is established. Default is zero (no
   timeout). 
   [fox]

*) Added possible fix for keyserver running on a cluster of login
   servers.
   [steve]

*) Applied Christopher Maxwell's patch to mod_pubcookie.c to fix
   multiple version strings in Server header. 
   [willey]

*) Replaced (server)->port with ap_get_server_port(), and
   ap_get_local_host() with (server)->server_hostname, to allow the
   port numbers to be correct in virtual hosts in Apache 2.0 and
   eliminate local code for ap_get_local_host in the Apache 2.0
   version. 
   [fox]

*) Added keymgt_peers variable to allow keyservers to push to hosts
   not in their cluster.
   [willey]

*) Added starter.key for keystore initialization.
   [dors]

*) Revised login-install.html guide and config.html reference for 3.1 
   release. Added new templates.html reference and install-filter.html. 
   [dors]

*) Improved ISAPI filter behavior when crypt key does not exist for 
   virtual host: if the page is authtype NONE, it will still serve the
   page. 
   [ryanc]

*) Added message source registry entries for pubcookie, pubcookie-1, 
   pubcookie-2, pubcookie-3 to filter installer.  This is to work
   around problem with IIS 6 in that it sometimes does not have the
   permissions at runtime to modify the registry. 
   [ryanc]
